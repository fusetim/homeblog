---
import { render } from "astro:content";
import BasePost from "../../layouts/post/BasePost.astro"

import { getAllBlogPosts, getBlogPost, getBlogPostReadTime, getBlogPostWordCount, getRawBlogPost, type BlogPost } from "../../libs/posts";

export async function getStaticPaths() {
    const posts = await getAllBlogPosts();
    return posts.map((post) => ({
        params: { id: post.id},
        props: { post },
    }));
}

const { post } = Astro.props;
const entry = await getRawBlogPost(post.id);

const { Content } = await render(entry);
const readTime = getBlogPostReadTime(entry);
const wordCount = getBlogPostWordCount(entry);

---

<BasePost {...post} readTime={readTime ?? undefined} wordCount={wordCount ?? undefined}>
    <Content />
</BasePost>